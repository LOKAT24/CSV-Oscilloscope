<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV-Oscilloscope</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Style specific to index.html */
        body {
            flex-direction: column;
        }
        .header {
            flex-shrink: 0;
            padding: 10px 20px;
            background-color: #2a2a2a;
            text-align: center;
            border-bottom: 1px solid #444;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            position: relative;
        }
        .main-controls-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: flex-start;
            width: 100%;
            padding: 10px 0;
        }
        .control-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        .section-title {
            width: 100%;
            padding-bottom: 5px;
            margin-bottom: 5px;
        }
        h1 {
            font-size: 1.5em;
            margin: 0 0 5px 0;
        }
        #file-input {
            display: none;
        }
        #status {
            font-size: 0.9em;
            color: #bbb;
            min-height: 1.1em;
            width: 100%;
        }
        #separator-info {
            font-size: 0.8em;
            color: #888;
            min-height: 1em;
            margin-top: -5px;
        }
        .fft-control {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ccc;
            font-size: 0.9em;
        }
        .fft-control input, .fft-control select {
            background-color: #222;
            color: #eee;
            border: 1px solid #555;
            border-radius: 3px;
            padding: 4px;
            font-family: inherit;
            font-size: 0.9em;
        }
        .fft-control input { width: 60px; }
        #measurements-panel { top: 10px; right: 10px; }
        #auto-measurements-panel { top: 10px; left: 10px; }
        #fft-peaks-panel { top: 150px; right: 10px; display: none; }
        #hint-panel {
            bottom: 10px;
            left: 10px;
            pointer-events: all;
            display: block;
        }
        #hint-panel-close {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background-color: #555;
            color: #fff;
            border: 1px solid #888;
            border-radius: 50%;
            cursor: pointer;
            text-align: center;
            line-height: 18px;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="top-right-nav">
            <a href="generator.html" class="btn">Generator Sygnału</a>
        </div>
        <h1>Wizualizator Przebiegów CSV</h1>
        <div class="main-controls-container">
            <div class="control-section">
                <span class="section-title">Plik i Widok</span>
                <label for="file-input" class="btn">
                    <svg viewBox="0 0 24 24" style="fill:currentColor; stroke:none;"><path d="M4 4h7l2 2h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"></path></svg>
                    <span>Wybierz plik</span>
                </label>
                <input type="file" id="file-input" accept=".csv,.txt">
                <div id="separator-info"></div>
                <button id="reset-view-btn" class="btn">
                    <svg viewBox="0 0 24 24"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.2-3.2l-4.2 4.2A4 4 0 1 0 11 18.9V22h-1a10 10 0 0 1-8-10.5z"></path></svg>
                    <span>Resetuj Widok</span>
                </button>
            </div>
            <div class="control-section">
                <span class="section-title">Tryb Wyświetlania</span>
                <div class="radio-group" id="render-mode-controls">
                    <label>
                        <input type="radio" name="renderMode" value="minmax" checked>
                        <svg viewBox="0 0 24 24"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>
                        <span>Szybki</span>
                    </label>
                    <label>
                        <input type="radio" name="renderMode" value="points">
                        <svg viewBox="0 0 24 24" style="fill:currentColor; stroke:none;"><circle cx="12" cy="12" r="1.5"></circle><circle cx="19" cy="5" r="1.5"></circle><circle cx="5" cy="19" r="1.5"></circle><circle cx="5" cy="5" r="1.5"></circle><circle cx="19" cy="19" r="1.5"></circle></svg>
                        <span>Punkty</span>
                    </label>
                    <label>
                        <input type="radio" name="renderMode" value="line">
                        <svg viewBox="0 0 24 24"><polyline points="3 12 8 7 16 17 21 12"></polyline></svg>
                        <span>Linia</span>
                    </label>
                </div>
                 <div class="slider-control">
                     <label for="optimization-slider">Gęstość:</label>
                     <input type="range" id="optimization-slider" min="1" max="100" value="1">
                     <span id="density-info"></span>
                </div>
            </div>
            <div class="control-section">
                <span class="section-title">Narzędzia</span>
                <button id="cursors-toggle-btn" class="btn">
                    <svg viewBox="0 0 24 24"><path d="M4 9h16M4 15h16M9 4v16M15 4v16"></path></svg>
                    <span>Kursory</span>
                </button>
                <button id="auto-measure-toggle-btn" class="btn">
                    <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><rect x="7" y="7" width="3" height="5"></rect><rect x="14" y="7" width="3" height="5"></rect><line x1="7" y1="15" x2="17" y2="15"></line><line x1="10" y1="12" x2="14" y2="12"></line></svg>
                    <span>Pomiary Auto</span>
                </button>
                <button id="fft-toggle-btn" class="btn">
                    <svg viewBox="0 0 24 24"><path d="M3 3v18h18"></path><path d="M7 12h2l2-4 2 8 2-4h2"></path></svg>
                    <span>Analiza FFT</span>
                </button>
                 <div class="fft-control" id="fft-controls" style="display: none;">
                     <div>
                         <label for="fft-freq-input">Zakres:</label>
                         <input type="number" id="fft-freq-input" value="100">
                         <select id="fft-unit-select">
                             <option value="1">Hz</option>
                             <option value="1000" selected>kHz</option>
                             <option value="1000000">MHz</option>
                         </select>
                     </div>
                     <button id="fft-peaks-toggle-btn" class="btn">
                        <svg viewBox="0 0 24 24"><path d="M3 20h18L12 4z"></path></svg>
                        <span>Wykryj Piki</span>
                    </button>
                     <div id="fft-peaks-controls" style="display: none;">
                        <label for="fft-peaks-input">Liczba pików:</label>
                        <input type="number" id="fft-peaks-input" value="5" min="1" max="20" style="width: 50px;">
                     </div>
                </div>
            </div>
        </div>
        <div id="status">Wybierz plik, aby rozpocząć.</div>
    </div>

    <div id="canvas-container">
        <canvas id="plot-canvas"></canvas>
        <div id="measurements-panel" class="panel"></div>
        <div id="auto-measurements-panel" class="panel"></div>
        <div id="fft-peaks-panel" class="panel"></div>
        <div id="tooltip-panel" class="panel"></div>
        <div id="hint-panel" class="panel">
            <div id="hint-panel-close">&times;</div>
            <b>Wskazówki:</b><br>
            - Zoom X: Kółko myszy<br>
            - Zoom Y: Ctrl + Kółko<br>
            - Przesuń: Przeciągnij
        </div>
    </div>

    <script src="js/chart_plotter.js"></script>
    <script src="js/oscilloscope.js"></script>
</body>
</html>